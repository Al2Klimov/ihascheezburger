name: on-gh-pr.js
on:
  pull_request:
    types:
      - opened

jobs:
  on-gh-pr.js:
    name: on-gh-pr.js
    runs-on: ubuntu-latest

    steps:
      - name: on-gh-pr.js
        uses: Icinga/on-gh-pr.js@master
        with:
          issue: '${{ github.event.pull_request.number }}'
          token: '${{ secrets.GITHUB_TOKEN }}'
          script: |
            var pull = GitHub.api("/repos/" + repo.owner + "/" + repo.name + "/pulls/" + pr.number, {}, "");
            if (pull.status != 200) {
              throw "HTTP " + pull.status;
            }
            var body = JSON.parse(pull.body);
            console.log(body.base.ref);
